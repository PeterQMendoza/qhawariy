{% extends 'base.html' %}
{% block title %}
    Agrega permiso
{% endblock %}
{% block head %}
    {{ super() }}
{% endblock %}
{% block navigation %}
    {% if current_user.is_authenticated %}
        <a href="{{url_for('home.index')}}" class="q-icon-costumer">
            <div class="mr-4 w-6 h-6">
                <img src="{{ url_for('static', filename='img/home.svg') }}" alt="qhawariy" srcset="" class="block q-icon-normal">
            </div>
            Inicio
        </a>
        <a href="{{url_for('cronograma_vehiculos.mostrar_cronograma' ,busca='todos')}}" class="q-link-active q-link-exact-active ">
            <div class="mr-4 w-6 h-6">
                <img src="{{ url_for('static', filename='img/schedule_vehicle_blue.svg') }}" alt="qhawariy" srcset="" class="block q-icon-active">
            </div>
            Asignación de flota
        </a>
        <a href="{{url_for('programacion.agregar_programacion')}}" class="q-icon-costumer">
            <div class="mr-4 w-6 h-6">
                <img src="{{ url_for('static', filename='img/schedule.svg') }}" alt="qhawariy" srcset="" class="block q-icon-normal">
            </div>
            Programaciones
        </a>
        <a href="{{url_for('estadistica.mostrar_estadisticas')}}" class="q-icon-costumer">
            <div class="mr-4 w-6 h-6">
                <img src="{{ url_for('static', filename='img/statistic.svg') }}" alt="qhawariy" srcset="" class="block q-icon-normal">
            </div>
            Estadisticas
        </a>
    {% endif %}
{% endblock %}
{% block linker %}
<div class="flex">
    <img src="{{url_for('static', filename='img/icon-angle-right.svg')}}" alt="Descargar" class="">
</div>
<a href="{{ url_for('home.index') }}" class="btn--base">
    <p class="text-h3">Inicio</p>
</a>
<div class="flex">
    <img src="{{url_for('static', filename='img/icon-angle-right.svg')}}" alt="Descargar" class="">
</div>
<a href="{{url_for('cronograma_vehiculos.mostrar_cronograma',busca='todos')}}" class="btn--base">
    <p class="text-h3">Asignación de flota</p>
</a>
<div class="flex">
    <img src="{{url_for('static', filename='img/icon-angle-right.svg')}}" alt="Descargar" class="">
</div>
<a href="#" class="btn--base">
    <p class="text-h3">Agregar actividad</p>
</a>
{% endblock %}
{% block content %}
<form action="" method="post" class="mt-3 p-4 border border-cream-100">
    {{form_agrega.hidden_tag()}}
    <div class="grid grid-cols-1 gap-x-0">
        <div class="col-span-1 order-1">
            <p class="text-h5 text-center">
                Ingrese los datos para agregar actividad
            </p>
        </div>
        <div class="mt-3 order-2">
            <div class="relative">
                <div class="w-full block">
                    {{ form_agrega.id_vehiculo.label }}
                    {{ form_agrega.id_vehiculo(class="rounded-xxs border text-black-100 text-sm w-full px-4 py-3 border-gray-209", placeholder="Numero de flota", autocomplete="off") }}<br>
                </div>
            </div>
            {% for error in form_agrega.id_vehiculo.errors %}
            <span class="text-red-600 text-xs">{{ error }}</span>
            {% endfor %}
        </div>
        <div class="order-3 grid grid-cols-3-1-1 gap-x-4 sm:grid-cols-1 sm:gap-x-0">
            <div class="mt-3 order-1 ">
                <div class="relative">
                    <div class="w-full block">
                        {{ form_agrega.fecha_inicio.label }}
                        {{ form_agrega.fecha_inicio(class="rounded-xxs border text-black-100 text-sm w-full px-4 py-3 border-gray-209", placeholder="Fecha inicio", autocomplete="off") }}<br>
                    </div>
                </div>
                {% for error in form_agrega.fecha_inicio.errors %}
                <span class="text-red-600 text-xs">{{ error }}</span>
                {% endfor %}
            </div>
            <div class="mt-3 order-2">
                <div class="relative">
                    <div class="w-full block">
                        {{ form_agrega.fecha_final.label }}
                        {{ form_agrega.fecha_final(class="rounded-xxs border text-black-100 text-sm w-full px-4 py-3 border-gray-209", placeholder="Fecha final", autocomplete="off") }}<br>
                    </div>
                </div>
                {% for error in form_agrega.fecha_final.errors %}
                <span class="text-red-600 text-xs">{{ error }}</span>
                {% endfor %}
            </div>
            <div class="mt-3 order-3 flex items-center justify-center">
                <div class="relative">
                    <p class="text-body3 text-align-center uppercase font-semibold diff-days"></p>
                </div>
            </div>
        </div>
        <div class="order-4">
            <div class="mt-5 mb-3 flex items-center justify-center">
                {{ form_agrega.agregar(class="btn btn--base bg-green-600 text-white w-auto block text-center") }}
            </div>
        </div>
    </div>
</form>
{% endblock %}
{% block javascript %}
<script>
    document.addEventListener("DOMContentLoaded",()=>{
        const startDateInput=document.querySelector('#fecha_inicio');
        const endDateInput=document.querySelector('#fecha_final');
        const text=document.querySelector('.diff-days');
        
        function calcularDaysDiff() {
            const startDate=startDateInput.value;
            const endDate=endDateInput.value;
            
            if (startDate && endDate) {
                const start=new Date(startDate);
                const end=new Date(endDate);
                const diffTime=Math.abs(end-start);
                const diffDays=Math.ceil(diffTime/(1000*60*60*24))+1;
    
                text.textContent=`Cantidad de dias: \n${diffDays}`;
            } else{
                text.textContent=``;
            }
        }

        startDateInput.addEventListener("input",calcularDaysDiff);
        endDateInput.addEventListener("input",calcularDaysDiff);
    });
</script>
{% endblock %}

