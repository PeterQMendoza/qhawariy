<!DOCTYPE html>
<html lang="es">
<head>
    {% block head %}
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="refresh">
    <meta name="description" content="Realiza el control de flotas vehiculare con este aplicativo web">
    <title>{% block title %}{% endblock %}</title>
    <link rel="manifest" href="{{ url_for('static', filename='source/js/service/manifest.json') }}">
    <link rel="shortcut icon" href="{{ url_for('static', filename='img/icon_seq.ico') }}" type="image/x-icon">
    <!-- <link rel="stylesheet" href="{{ url_for('static', filename='dist/css/style_qhawariy.css') }}" type="text/css"> -->
    <link rel="stylesheet" href="{{ url_for('static', filename='source/styles/style.css') }}" type="text/css">
    <script src="{{ url_for('static', filename='dist/js/app_qhawariy.min.js') }}"  type="text/javascript"></script>
    {% endblock %}
</head>
<body class="">
    <div id="global">
        <div id="layout">
            <div class="layout-seqhawariy h-full">
                <!-- PANE-->
                <!-- por mejorar la navegacion -->
                {% if current_user.is_authenticated %}
                <div class="header-section">
                    <div class="navigation-drawer shadow">
                        <div class="navigation-header">
                            <h1>
                                <a href="" class="">Qhawariy</a>
                            </h1>
                        </div>
                        <div class="navigation-body h-full relative">
                            <div class="pt-[65px] lg:pt-0">
                                <!-- <h5 class="h-label">Panel</h5> -->
                            </div>
                            <div class="navigation-navbar">
                                {% block navigation %}
                                {% endblock %}
                            </div>
                        </div>
                        <div class="navigation-footer">
                            <a href="#" class="">
                                <p class="text-black-100">¿Quiénes Somos?</p>
                            </a>
                        </div>
                    </div>
                </div>
                {% endif %}
                <!-- PANE-->

                <!-- NAVBAR -->
                <div class="fixed top-0 z-1100 w-full border-b header bg-white border-gray-100 shadow">
                    <div class="container h-full flex items-center">
                        <div class="flex-1 h-full">
                            <div class="h-full flex">
                                <a href="{{ url_for('home.index')}}" class="seq-link-active h-full flex items-center bg-white sm:w-full">
                                    <img src="{{ url_for('static', filename='img/logo_navbar.svg') }}" height="34px" width="34px" alt="SEQhawariy" class="logo-seqhawariy">
                                    <p class="pl-2">Qhawariy</p>
                                </a>
                                <span class="hidden">Home</span>
                            </div>
                        </div>
                        {% if current_user.is_authenticated %}
                        <div class="relative pl-5 sm:pl-3">
                            <div class="menu-desktop lg:block">
                                <a href="#" class="btn-user rounded flex items-center cursor-pointer px-2 sm:px-1.5">
                                    <div class="">
                                        <object type="image/svg+xml" data="{{ url_for('static', filename='img/icon-avatar.svg') }}" class="px-2" width="42px" height="42px"></object>
                                    </div>
                                    <p class="sm:hidden">{{ current_user.nombres }}, {{ current_user.apellidos}}</p>
                                </a>
                                <div class="menu-user absolute bg-white right-0 z-1100 menu-dropdown shadow-custom rounded border border-gray-100 text-xs hidden">
                                    <a href="{{ url_for('auth.edit')}}" class="block px-4 py-3">Configuracion de perfil</a>
                                    <a href="{{ url_for('auth.logout')}}" class="block px-4 py-3 h-full">Cerrar Sesion</a>
                                </div>
                            </div>
                        </div>
                        <div class="relative pl-5 sm:pl-3">
                            <div class="menu-desktop lg:block">
                                <a href="#" class="btn-menu px-2 sm:px-1.5 cursor-pointer flex items-center">
                                    <img type="image/svg+xml" src="{{ url_for('static', filename='img/icon-menu.svg') }}" class="px-2" width="36px" height="36px" alt="menu"/>
                                </a>
                                <!-- <iframe src="{{ url_for('static', filename='img/icon-menu.svg') }}" class="btn-menu px-2 sm:px-1.5 cursor-pointer" width="36px" height="36px" frameborder="0" allowfullscreen sandbox></iframe> -->
                                <div class="menu-element absolute bg-white right-0 z-1100 menu-dropdown rounded border shadow-custom border-gray-100 text-xs hidden">
                                    <a href="/" class="block px-4 py-3">¿Quienes somos?</a>
                                    <a href="/" class="block px-4 py-3">Opina sobre
                                        <span class="text-green-600 font-bold">System Expert</span>
                                        <span class="text-blue-600 font-bold">Qhawariy</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>
                <!-- NAVBAR -->

                <!-- MODAL (mensaje flash)-->
                {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages%}
                {% for category, message in messages %}
                <div class="fixed modal-notificacion z-1100">
                    <div class="rounded shadow-custom bg-white text-black-100 p-4">
                        <div class="">
                            <div class="flex items-center">
                                {% if category=='info' %}
                                <object type="image/svg+xml" data="{{ url_for('static', filename='img/icon-error-info.svg') }}" width="20px" height="20px"></object>
                                <p class="uppercase ml-2">información</p>
                                {% endif %}
                                {% if category=='message' %}
                                <object type="image/svg+xml" data="{{ url_for('static', filename='img/icon-error-message.svg') }}" width="20px" height="20px"></object>
                                <p class="uppercase ml-2">Mensaje</p>
                                {% endif %}
                                {% if category=='error' %}
                                <object type="image/svg+xml" data="{{ url_for('static', filename='img/icon-error-critical.svg') }}" width="20px" height="20px"></object>
                                <p class="uppercase ml-2">Error</p>
                                {% endif %}
                                <img src="{{ url_for('static', filename='img/icon-close.svg') }}" class="icon-close-m p-1 m-2 rounded-full absolute right-0 bg-white cursor-pointer" width="20px" height="20px" alt="cerrar"/>
                            </div>
                            <p class="text-sm text-align-left text-justify pt-2">{{message}}</p>
                        </div>
                    </div>
                </div>
                {% endfor %}
                {% endif %}
                {% endwith %}
                <!-- MODAL -->

                <!-- BODY -->
                <div class="body bg-tile overflow-x-hidden">
                    <div class="admin-page">
                        <div class="md:pb-8 relative px-0">
                            <div class="admin-detail">
                                <div class="w-full">
                                    <div class="admin-module-info bg-white-250 px-4 md:w-full md:block block w-full shadow">
                                        <div class="px-0 md:px-6 pb-2">
                                            {% if current_user.is_authenticated %}
                                            <div class="flex items-center border-b border-cream-100 linker py-2">
                                                {% block linker %}
                                                {% endblock %}
                                            </div>
                                            {% endif %}
                                            {% block content %}{% endblock %}
                                            <div class="flex hidden">
                                                <button class="btn btn--base btn-green-600 hidden" id="installButton" hidden>Instalar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- COOKIE -->
                    <!-- No debe ir por que no requiere informacion personal de la poblacion -->
                    <div>
                        <section class="cookie-control hidden" >
                            <div class="cookie-control-bar cookie-control-bar-bottom-full">
                                <div class="cookie-control-bar-container md:cookie-control-bar-container">
                                    <div class="">
                                        <h3 class="font-semibold">Política de Cookies</h3>
                                        <p class="font-light">
                                            Esta página utiliza cookies necesarias, para mejorar tu experiencia en tu navegacion. Puedes Aceptar todas las cookies en "Aceptar Cookies"
                                        </p>
                                        <p>
                                            Para obtener más información visita nuestra 
                                            <a href="{#{ url_for('home.mostrar_politicas_cookies')}#}" class="btn-cookie mt-0">Política de Cookies</a>
                                        </p>
                                    </div>
                                    <div class="cookie-control-bar-buttons md:cookie-control-bar-buttons">
                                        <button class="btn btn--base btn-green-600 btn-aceptar">
                                            Aceptar
                                            <span>cookies</span>
                                        </button>
                                        <button class="btn btn--base btn-blue-100 btn-modal-active">
                                            Configurar
                                            <span>cookies</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="cookie-control-modal hidden">
                                <div class="cookie-control-modal-content">
                                    <div>
                                        <div class="content-description">
                                            <h3>
                                                <strong> Configuracion de Cookies</strong>
                                            </h3>
                                            <p>
                                                Las cookies son pequeños archivos de texto que se almacenan de forma local en la memoria de los navegadores
                                                web. Esto contribuye a ofrecer un mejor servicio a nuestros usuarios.
                                            </p>
                                            <p>
                                                A modo de ejemplo, el uso de cookies nos permite entender cómo un usuario navega en nuestra web, qué
                                                interacciones lleva a cabo, recordar los detalles de acceso y almacenar las preferencias de navegación. Sin
                                                embargo, el bloqueo de algunos tipos de cookies puede afectar su experiencia en nuestro sitio web y los
                                                servicios que ofrecemos.
                                            </p>
                                            <p>
                                                En cada sección se explica cómo utilizamos cada tipo de cookie para asegurarnos que nuestros servicios
                                                funcionan correctamente, mejorar la experiencia de uso y analizar datos. Haz click en las diferentes
                                                secciones para saber más y cambiar la configuración predeterminada.
                                            </p>
                                        </div>
                                        <button class="cookie-control-modal-close">Cerrar</button>
                                        <div>
                                            <h3>Cookie obligatorias:</h3>
                                            <ul>
                                                <li class="mb-2">
                                                    <div class="cookie-control-modal-input-wrapper">
                                                        <span class="cookie-control-modal-cookie-name">
                                                            <span>
                                                                -
                                                                <b>NECESARIAS:</b>
                                                                Son las que permiten la navegación óptima y el
                                                                acceso a áreas seguras de la página web. La página web
                                                                no podrá funcionar adecuadamente sin estas cookies.
                                                                Con éstas también nos aseguramos que se cumpla la ley
                                                                de protección de datos personales. Le informamos de
                                                                que puede configurar su navegador para bloquear o
                                                                alertar sobre estas cookies, sin embargo, es posible
                                                                que determinadas áreas de la página web no funcionen.
                                                                Estas cookies no almacenan ninguna información de
                                                                identificación personal.
                                                            </span>
                                                        </span>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                        <div>
                                            <h3>
                                                Cookie opcionales:
                                            </h3>
                                            <ul>
                                                <li class="mb-2">
                                                    <div class="cookie-control-modal-input-wrapper">
                                                        <span class="cookie-control-modal-cookie-name">
                                                            <span>
                                                                -
                                                                <b>ANALÍTICAS:</b>
                                                                Son aquellas que permiten al Editor de las mismas,
                                                                el seguimiento y análisis del comportamiento de los
                                                                usuarios de los sitios web a los que están vinculados.
                                                                La información recogida mediante este tipo de cookies
                                                                se utiliza en la medición de la actividad de los
                                                                sitios web, aplicación o plataforma y para la
                                                                elaboración de perfiles de navegación, con el fin de
                                                                introducir mejoras en función del análisis de los
                                                                datos de uso que hacen los usuarios del servicio.
                                                            </span>
                                                        </span>
                                                    </div>
                                                    <!---->
                                                </li>
                                                <li class="mb-2">
                                                    <div class="cookie-control-modal-input-wrapper">
                                                        <span class="cookie-control-modal-cookie-name">
                                                            <span>
                                                                 - 
                                                                <b>MARKETING:</b>
                                                                Son aquellas colocadas por nuestros socios
                                                                publicitarios. Estos negocios pueden utilizarlas para
                                                                crear un perfil de sus intereses y mostrarle anuncios
                                                                relevantes en otros sitios. No almacenan información
                                                                personal directamente, sino que se basan en la
                                                                identificación única de su navegador y dispositivo de
                                                                acceso a Internet. Esta categoría de cookies es
                                                                voluntaria, de no otorgar su consentimiento no podrá
                                                                cumplir con la finalidad antes descrita.
                                                            </span>
                                                        </span>
                                                    </div>
                                                    <!---->
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="cookie-control-modal-buttons text-center">
                                            <button class="btn btn--base btn-blue-100">Solo las cookies necesarias</button>
                                            <button class="btn btn--base btn-green-600">Aceptar todas las cookies</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
                <!-- BODY -->

                <!-- FOOTER -->
                {% block footer %}
                <div class="section-footer bg-black-g">
                    <div class="container">
                        <div class="content-footer">
                            <div class="block-logo">
                                <a href="/" class="" aria-label="Inicio">
                                    <object type="image/svg+xml" data="{{ url_for('static', filename='img/logo_footer.svg') }}" class="logo-seqhawariy" width="400px" height="247px"></object>
                                </a>
                            </div>
                            <div class="block-menu sm:mt-4">
                                <p class="p-title mb-2 text-white-100">Contactanos</p>
                                <a href="mailto:peterqm@hotmail.com" class="px-0 py-2">
                                    <object type="image/svg+xml" data="{{ url_for('static', filename='img/icon-mail.svg') }}" width="20px" height="12px"></object>
                                    <p class="pl-2">peterqm@hotmail.com</p>
                                </a>
                                <p class="p-title mt-3 mb-2">Legal</p>
                                
                                <a href="" class="py-2">Terminos y condiciones</a>
                                <a href="" class="py-2">Politicas de privacidad</a>
                                <p class="p-copy mt-3">© Copyright 2025 - Todos los derechos reservados</p>
                            </div>
                        </div>
                    </div>
                </div>
                {% endblock %}
                <!-- FOOTER -->
            </div>
        </div>
    </div>
    {% block javascript %}
    <script type="text/javascript">
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register("{{ url_for('home.service_worker') }}")
                .then(function(registration) {
                    console.log('Service Worker registrado con éxito:', registration);
                }, function(error) {
                    console.log('Fallo en el registro del Service Worker:', error);
                });
            });
        }

        let deferredPrompt=null;
        const installButton = document.querySelector("#installButton");

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installButton.hidden = false;

            installButton.addEventListener('click', async () => {

                if(!deferredPrompt){
                    return;
                }

                installButton.hidden = true;
                deferredPrompt.prompt();

                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('El usuario aceptó instalar la PWA');
                    } else {
                        console.log('El usuario rechazó instalar la PWA');
                    }

                    deferredPrompt = null;
                });
            });
        });
    </script>
    {% endblock %}
</body>
</html>