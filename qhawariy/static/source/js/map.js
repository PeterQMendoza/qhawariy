document.addEventListener('DOMContentLoaded',()=>{
    

    var osm=L.tileLayer('https://.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
    });

    
    var osmHOT = L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
    });

    // var  myIcon = L.divIcon({className: 'icon-map'});

    // var term1=L.marker([-11.94747588486606,-75.25714076428949],{icon: myIcon})
    var term1=L.marker([-11.94747588486606,-75.25714076428949])
        .bindPopup("Terminal Saño")
        .openPopup()
        .bindTooltip("Terminal Saño")
        .openTooltip();
    var term2=L.marker([-12.10288628638977,-75.22249878242785])
        .bindPopup("Terminal Huancan")
        .openPopup()
        .bindTooltip("Terminal Huancan")
        .openTooltip();

    var lonLatPar=[
        [-11.96908815874015,-75.26985013708068],
        [-11.98713789596742,-75.25975818625614],
        [-12.02213464482165,-75.24012381706687],
        [-12.04964613534191,-75.22212028325909],
        [-12.05981857659807,-75.21438548986852],
        [-12.06290855821303,-75.20812512031195],
        [-12.07918432602255,-75.20613110940789],
        [-12.09963818786580,-75.21831781849453]
    ]

    var nombre_paradero=[
        "Paradero 1",
        "Paradero 2",
        "Paradero 3",
        "Paradero 4: Calle de paradero",
        "Paradero 5",
        "Paradero 6",
        "Paradero 7",
        "Paradero 8",
    ]

    var groupMarker=[]
    lonLatPar.forEach((element)=>{
        const i=lonLatPar.indexOf(element)
        if(i===-1){
            // No Existe en array
        }
        else if(i>-1)
        {
            //Ya existe en el array
            var par=L.marker(element)
            .bindPopup(nombre_paradero[i])
            .openPopup()
            .bindTooltip(nombre_paradero[i])
            .openTooltip();
            groupMarker.push(par)
        }
    });

    var paraderos = L.layerGroup(groupMarker);
    var terminales=L.layerGroup([term1,term2]);
    var baseMaps = {
        "OpenStreetMap": osm,
        "OpenStreetMap.HOT": osmHOT
    };
    
    var overlayMaps = {
        "Paraderos": paraderos,
        "Terminales":terminales,
    };
    
    var map = L.map('map',{
        center:[-12.0643,-75.1774],
        zoom: 11.9056,
        // layers: [osm,cities]
    }).fitWorld();
    
    var layerControl = L.control.layers(baseMaps, overlayMaps).addTo(map);
    var options={
        maxWidth: 200,
        metric: true,
  		imperial: false
    }
    var scale=L.control.scale(options).addTo(map);
    var popup = L.popup();

    function onMapClick(e) {
        popup
            .setLatLng(e.latlng)
            .setContent("Tu clickeaste el mapa en:" + e.latlng.toString())
            .openOn(map);
    }

    map.on('click', onMapClick);

    var latlngs = [
        [-11.94747588486606,-75.25714076428949],
        [-11.94950108974976,-75.25636385817658],
        [-11.95218606148375,-75.25540534258731],
        [-11.95218606148375,-75.25540534258731],
        [-11.95280690601067,-75.25515410229504],
        [-11.95372248466296,-75.25484577214326],
        [-11.95406831695411,-75.25471028869100],
        [-11.95475587643963,-75.25450401360735],
        [-11.95536312764952,-75.25427731349821],
        [-11.95559535837913,-75.25484061113372],
        [-11.95627120191356,-75.25645384380203],
        [-11.95627120191356,-75.25645384380203],
        [-11.95646147582790,-75.25684818481123],
        [-11.95656102929182,-75.25700293056987],
        [-11.95656898775072,-75.25717566906907],
        [-11.95682740939456,-75.25761945606342],
        [-11.95715054416406,-75.25835186104220],
        [-11.95720999286532,-75.25841021531255],
        [-11.95727165551399,-75.25842837403547],
        [-11.95823576558311,-75.25799426668368],
        [-11.95829325993796,-75.25799427023205],
        [-11.95834366884468,-75.25803132816866],
        [-11.96015090425627,-75.26003792558693],
        [-11.96015090425627,-75.26003792558693],
        [-11.96384038673795,-75.26409609293081],
        [-11.96590674896706,-75.26639756224543],
        [-11.96590674896706,-75.26639756224543],
        [-11.96901904439549,-75.26983949455301],
        [-11.96908815874015,-75.26985013708068],
        [-11.96908815874015,-75.26985013708068],// paradero
        [-11.98713789596742,-75.25975818625614],// paraderp
        [-11.99447849639115,-75.25564293468423],
        [-12.00604924734210,-75.24916856305396],
        [-12.01138817482021,-75.24623168495873],
        [-12.01284481700108,-75.24537270029283],
        [-12.01626477224912,-75.24346614425112],
        [-12.01848389213945,-75.24219455133128],
        [-12.02081640406043,-75.24091856370254],
        [-12.02213464482165,-75.24012381706687],// paradero
        [-12.02570359768655,-75.23775228195218],
        [-12.02570359768655,-75.23775228195218],
        [-12.03050475172340,-75.23451315401304],
        [-12.03120741495547,-75.23410415927471],
        [-12.03205963295369,-75.23347558337066],
        [-12.03849353447872,-75.22932004517726],
        [-12.04350639138424,-75.22607620817078],
        [-12.04478558496609,-75.22515438803025],
        [-12.04663022266666,-75.22403114437871],
        [-12.04663022266666,-75.22403114437871],
        [-12.04804347960452,-75.22313512251148],
        [-12.04886450427911,-75.22264020300929],
        [-12.04964613534191,-75.22212028325909],// paradero
        [-12.05025480509747,-75.22174971898120],
        [-12.05057422947391,-75.22153173741241],
        [-12.05065182025618,-75.22152238002199],
        [-12.05071343648143,-75.22158039361659],
        [-12.05144139247304,-75.22216216505137],
        [-12.05154163478434,-75.22221393306198],
        [-12.05163241299969,-75.22217339321054],
        [-12.05177493380675,-75.22203143953507],
        [-12.05198628132491,-75.22188050371777],
        [-12.05232893985812,-75.22166462315495],
        [-12.05299899809600,-75.22121170687846],
        [-12.05338608975215,-75.22095216898155],
        [-12.05372196820241,-75.22071174458797],
        [-12.05372196820241,-75.22071174458797],
        [-12.05400691623752,-75.22055804937295],
        [-12.05468174840938,-75.22009741487572],
        [-12.05471183365341,-75.22004329865693],
        [-12.05471703254759,-75.22000229762020],
        [-12.05470334024541,-75.21996631183680],
        [-12.05379957859321,-75.21847618365142],
        [-12.05380213369127,-75.21843929954619],
        [-12.05380247601537,-75.21840434391406],
        [-12.05459091829098,-75.21790711151830],
        [-12.05528911352897,-75.21746552300669],
        [-12.05577004969639,-75.21715071856930],
        [-12.05607281147218,-75.21686872295624],
        [-12.05639413170961,-75.21656262425108],
        [-12.05661399054301,-75.21640682676501],
        [-12.05668691893358,-75.21634959203166],
        [-12.05663071687099,-75.21624624359954],
        [-12.05663052342125,-75.21611684022393],
        [-12.05713545898377,-75.21579109923705],
        [-12.05720241170103,-75.21579722281118],
        [-12.05731701502291,-75.21595165489570],
        [-12.05737624117257,-75.21595770688575],
        [-12.05791960757508,-75.21560299812680],
        [-12.05857821580193,-75.21519550868112],
        [-12.05906340548509,-75.21486334770201],
        [-12.05981857659807,-75.21438548986852],// paradero
        [-12.06016811144977,-75.21416353487027],
        [-12.06113887598354,-75.21360557560828],
        [-12.06114813624999,-75.21355768868628],
        [-12.06035532659441,-75.21221987428352],
        [-12.05966423058449,-75.21107726672039],
        [-12.05963172271008,-75.21091728754689],
        [-12.05969678754997,-75.21083183672808],
        [-12.06027503910858,-75.21038585773540],
        [-12.06055572641905,-75.21011023273799],
        [-12.06201859488437,-75.20879998217278],
        [-12.06222860875898,-75.20861177260528],
        [-12.06263062491613,-75.20830481568048],
        [-12.06290855821303,-75.20812512031195],// paradero
        [-12.06364663261113,-75.20771372623469],
        [-12.06397041356978,-75.20756156920676],
        [-12.06492060055627,-75.20705811596687],
        [-12.06628895560867,-75.20637091268559],
        [-12.06669105259481,-75.20617939969169],
        [-12.06683293919541,-75.20597793359006],
        [-12.06701625152234,-75.20579424393635],
        [-12.06766266367510,-75.20545711457392],
        [-12.06800657666147,-75.20530781744887],
        [-12.06867348790950,-75.20521200143011],
        [-12.06891539054081,-75.20516416672244],
        [-12.06948062095572,-75.20499161503376],
        [-12.07048457883597,-75.20468241595499],
        [-12.07095908198288,-75.20456465207047],
        [-12.07281621375027,-75.20480171282068],
        [-12.07601730497181,-75.20532373441334],
        [-12.07656627067815,-75.20550736064664],
        [-12.07777597709721,-75.20655506575274],
        [-12.07793955554530,-75.20661864948360],
        [-12.07817659074369,-75.20657279342240],
        [-12.07918432602255,-75.20613110940789],// paradero
        [-12.08008080468524,-75.20579866143910],
        [-12.08120050572328,-75.20532710336224],
        [-12.08213672647563,-75.20487107830577],
        [-12.08266734983803,-75.20462972014992],
        [-12.08366027645442,-75.20411819576829],
        [-12.08368909787672,-75.20412406015920],
        [-12.08418147744730,-75.20497771846696],
        [-12.08608038569998,-75.20806975008701],
        [-12.08609093296581,-75.20817726802686],
        [-12.08602778031192,-75.20830645611531],
        [-12.08614889562412,-75.20845702386811],
        [-12.08631751348672,-75.20850007978389],
        [-12.08696830627570,-75.20954261362935],
        [-12.08857902405392,-75.21210100913926],
        [-12.08892062478697,-75.21265966112297],
        [-12.09034615396199,-75.21490293810535],
        [-12.09051407882780,-75.21517390382378],
        [-12.09065563040675,-75.21526881107516],
        [-12.09065563040675,-75.21526881107516],
        [-12.09303773639371,-75.21586114563858],
        [-12.09477929151475,-75.21628872367246],
        [-12.09516799624442,-75.21643820964536],
        [-12.09544546714123,-75.21652579047286],
        [-12.09596969822942,-75.21662240940057],
        [-12.09673339965457,-75.21690214331241],
        [-12.09794484658449,-75.21726116667909],
        [-12.09843109345024,-75.21740076110946],
        [-12.09883627524201,-75.21755274310661],
        [-12.09925026591757,-75.21785182395999],
        [-12.09963818786580,-75.21831781849453],// paradero
        [-12.10006331530793,-75.21901990672262],
        [-12.10048370831631,-75.21962801717829],
        [-12.10110628743341,-75.22038004230482],
        [-12.10185858664066,-75.22127150148401],
        [-12.10223984821253,-75.22172716291956],
        [-12.10271558016201,-75.22225429527832],
        [-12.10288628638977,-75.22249878242785],
    ];
    
    var polyline = L.polyline(latlngs, {color: 'red'}).addTo(map);
    // zoom the map to the polyline
    map.fitBounds(polyline.getBounds());

});